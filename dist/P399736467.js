Ada.unpack({"P69983494":{"hash":"4f286051","code":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var _dec,_dec2,_dec3,_dec4,_dec5,_dec6,_dec7,_dec8,_class,_class2,_adajs=require(\"adajs\"),_displayer=require(\"displayer.js\"),_file=_interopRequireDefault(require(\"file.js\")),_refreshCw=_interopRequireDefault(require(\"photocutter/icons/refresh-cw.icon\")),_rotateCcw=_interopRequireDefault(require(\"photocutter/icons/rotate-ccw.icon\")),_rotateCw=_interopRequireDefault(require(\"photocutter/icons/rotate-cw.icon\")),_zoomIn=_interopRequireDefault(require(\"photocutter/icons/zoom-in.icon\")),_zoomOut=_interopRequireDefault(require(\"photocutter/icons/zoom-out.icon\")),_folder=_interopRequireDefault(require(\"photocutter/icons/folder.icon\"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _applyDecoratedDescriptor(e,t,i,h,o){var r={};return Object.keys(h).forEach(function(e){r[e]=h[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,(\"value\"in r||r.initializer)&&(r.writable=!0),r=i.slice().reverse().reduce(function(i,h){return h(e,t,i)||i},r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}class Cutter{constructor(e){let t=new _displayer.Scene({dom:e.dom,background:{image:\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAAAAAByaaZbAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjaY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBA3y7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BUNTVQYqg4jIKAX08EGIIUByaVEZhMXIwMDAIMCgxeDHUMmwiuEBozRjFOM8xqdMhkwNTJeYNZgbme+y2LDMY2VmzWa9yubEtoldhX0mhwBHJycrZzMXM1cbNzf3RB4pnqW8xryH+IL5nvFXCwgJrBZ0E3wk1CisKHxYJF2UV3SrWJw4p/hWiRRJYcmjUhXSutJPZObIhsoJyp2V71HwUeRVvKA0RTlKRUnltepWtUZ1Pw1Zjbea+7QmaqfqWOsK6b7SO6I/36DGMMrI0ljS+LfJPdPDZivM+y0qLBOtfKwtbFRtRexY7L7aP3e47XjB6ZjzXpetruvdVrov9VjkudBrgfdCn8W+y/xW+a8P2Bq4N+hY8PmQW6HPwr5EMEUKRilFG8e4xUbF5cW3JMxO3Jx0Nvl5KlOaXLpNRlRmVdas7D059/KY8tULfAqLi2YXHy55WyZR7lJRWDmv6mz131q9uvj6SQ3HGn83G7Skt85ru94h2Ond1d59uJehz76/bsK+if8nO05pnXpiOu+M4JmzZj2aozW3ZN6+BVwLwxYtXvxxqcOyCcsfrjRe1br65lrddU3rb2402NSx+cFWq21Tt3/Y6btr1R6Oven7jh9QP9h56PURv6Obj4ufqD355LT3mS3nZM+3X/h0Ke7yqasW15bdEL3ZeuvrnfS7N+/7PDjwyPTx6qeKz2a+EHzZ9Zr5Td3bn+9LP3z6VPD53de8b+9+5P/88Lv4z7d/Vf//AwAqvx2K829RWwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAAPElEQVR42mL8zwABZ6G0MQE+EwOJYFQDMYCF2PA3Hg1WWmpgHM0Po/lhVMNofhjND6MasAAAAAAA//8DAHstFMgoxduqAAAAAElFTkSuQmCC\",imageType:\"repeat\"},mousedown:function(t){t=t.getSpriteLocal(r),r.checkPointIn(t.x,t.y)&&(e.dom.style.cursor=\"move\",this.ops.ismove=!0,this.ops.ox=t.x-r.x(),this.ops.oy=t.y-r.y())},mouseup:function(){e.dom.style.cursor=\"default\",this.ops.ismove=!1},mousemove:function(e){if(e=e.getSpriteLocal(r),!0===this.ops.ismove){let i=e.x-this.ops.ox,h=e.y-this.ops.oy;i>s.x()?i=s.x():i<s.x()-r.width()+s.width()&&(i=s.x()-r.width()+s.width()),h>s.y()?h=s.y():h<s.y()-r.height()+s.height()&&(h=s.y()-r.height()+s.height()),r.x(i),r.y(h),t.draw()}}}),i=new _displayer.Sprite({name:\"ksprite\",x:0,y:0,width:e.sceneWidth,height:e.sceneHeight}),h=Math.sqrt(e.sceneWidth*e.sceneWidth+e.sceneHeight*e.sceneHeight),o=new _displayer.Sprite({name:\"rsprite\",x:(e.sceneWidth-h)/2,y:(e.sceneHeight-h)/2,width:h,height:h}).rotatePoint(e.sceneWidth/2,e.sceneHeight/2),r=new _displayer.Sprite({name:\"chone\",width:e.sceneWidth,height:e.sceneHeight,x:(o.width()-e.sceneWidth)/2,y:(o.height()-e.sceneHeight)/2,background:{color:\"rgba(102,102,102,0)\"}}).rotatePoint(o.width()/2,o.height()/2),s=new _displayer.Sprite({name:\"chtwo\",width:e.picWidth,height:e.picHeight,x:(o.width()-e.picWidth)/2,y:(o.height()-e.picHeight)/2,background:{color:\"rgba(66,54,48,0)\"}}),a=new _displayer.Sprite({name:\"chtwo\",width:e.picWidth,height:e.picHeight,x:(e.sceneWidth-e.picWidth)/2,y:(e.sceneHeight-e.picHeight)/2,border:{width:2,color:\"white\"},background:{color:\"rgba(255,255,255,0)\"},shadow:{color:\"#030303\",offsetX:3,offsetY:3,blur:10}}),c=new _displayer.Sprite({x:0,y:0,width:(e.sceneWidth-e.picWidth)/2,height:e.sceneHeight,background:{color:\"rgba(0,0,0,0.5)\"}}),d=new _displayer.Sprite({x:c.width()+e.picWidth,y:0,width:c.width(),height:c.height(),background:{color:\"rgba(0,0,0,0.5)\"}}),p=new _displayer.Sprite({x:c.width(),y:0,width:e.picWidth,height:(e.sceneHeight-e.picHeight)/2,background:{color:\"rgba(0,0,0,0.5)\"}}),n=new _displayer.Sprite({x:c.width(),y:p.height()+e.picHeight,width:p.width(),height:p.height(),background:{color:\"rgba(0,0,0,0.5)\"}}),l=new _displayer.Sprite({x:0,y:0,width:e.sceneWidth,height:e.sceneHeight});l.appendChild(c).appendChild(p).appendChild(d).appendChild(n).appendChild(a),o.appendChild(s).appendChild(r),i.appendChild(o),t.appendChild(i).appendChild(l).draw(),this.scene=t,this.mask=a,this.ksprite=i,this.rsprite=o,this.chone=r,this.chtwo=s,this.left=c,this.right=d,this.top=p,this.bottom=n,this.bg=l,this.ops=e}setPicArea(e,t){let i=this.ops,h=this.left,o=this.right,r=this.top,s=this.bottom,a=this.mask,c=this.chtwo,d=this.scene,p=this.rsprite;e<i.sceneWidth&&t<i.sceneHeight&&(this.reset(),i.picWidth=e,i.picHeight=t,h.x(),h.y(),h.width((i.sceneWidth-i.picWidth)/2),h.height(),o.x(h.width()+i.picWidth),o.y(),o.width(h.width()),o.height(),r.x(h.width()),r.y(),r.width(i.picWidth),r.height((i.sceneHeight-i.picHeight)/2),s.x(h.width()),s.y(r.height()+i.picHeight),s.width(r.width()),s.height(r.height()),a.width(i.picWidth),a.height(i.picHeight),a.x((i.sceneWidth-i.picWidth)/2),a.y((i.sceneHeight-i.picHeight)/2),c.width(i.picWidth),c.height(i.picHeight),c.x((p.width()-i.picWidth)/2),c.y((p.height()-i.picHeight)/2),d.draw())}rotate(e){let t=this.rsprite,i=this.scene;t.rotate(t.rotate()+e),i.draw()}rotateLeft(){this.rotate(-this.ops.rotateoffset)}rotateRight(){this.rotate(this.ops.rotateoffset)}zoom(e){let t=this.chone,i=this.chtwo,h=this.scene,o=t.width()+e;if(o>=i.width()){let e=t.height()/t.width()*o;t.width(o),t.height(e);let h=t.x(),r=t.y();h>i.x()?h=i.x():h<i.x()-t.width()+i.width()&&(h=i.x()-t.width()+i.width()),r>i.y()?r=i.y():r<i.y()-t.height()+i.height()&&(r=i.y()-t.height()+i.height()),t.x(h),t.y(r)}h.draw()}zoomIn(){this.zoom(this.ops.zoomoffset)}zoomOut(){this.zoom(-this.ops.zoomoffset)}getImageData(){let e=this.ksprite,t=this.mask;return{uri:e.getImageDate(t.x(),t.y(),t.width(),t.height()),blob:e.getImageBlob(t.x(),t.y(),t.width(),t.height())}}getImageURI(){let e=this.ksprite,t=this.mask;return e.getImageDate(t.x(),t.y(),t.width(),t.height())}getImageBlob(){let e=this.ksprite,t=this.mask;return e.getImageBlob(t.x(),t.y(),t.width(),t.height())}setImage(e){let t=e.width,i=e.height,h=this.chtwo,o=this.chone,r=this.rsprite,s=this.scene;t<h.width()&&(t=h.width(),i=e.height/e.width*t),i<h.height()&&(i=h.height(),t=e.width/e.height*i),o.ops.iw=t,o.ops.ih=i,o.width(t),o.height(i),o.x((r.width()-o.width())/2),o.y((r.height()-o.height())/2),r.rotate(0),o.backgroundImage(e),s.draw()}reset(){let e=this.chone,t=this.rsprite,i=this.scene;e.width(e.ops.iw),e.height(e.ops.ih),e.x((t.width()-e.width())/2),e.y((t.height()-e.height())/2),t.rotate(0),i.draw()}}let Photocutter=(_dec=(0,_adajs.view)({className:\"photocutter\",template:\"photocutter/template.html\",style:\"photocutter/style.scss\",module:\"photocutter.js\"}),_dec2=(0,_adajs.binder)(\"change\"),_dec3=(0,_adajs.binder)(\"rotateleft\"),_dec4=(0,_adajs.binder)(\"rotateright\"),_dec5=(0,_adajs.binder)(\"zoomin\"),_dec6=(0,_adajs.binder)(\"zoomout\"),_dec7=(0,_adajs.binder)(\"reset\"),_dec8=(0,_adajs.binder)(\"upload\"),_dec((_applyDecoratedDescriptor((_class2=class extends _adajs.View{oncreated(){let e=this.option,t=this.getDDM().finder(\"cutter\").getElement(),i=t.getBoundingClientRect();e.dom=t,e.sceneHeight=i.height,e.sceneWidth=i.width,e.size=1024*e.size*1024,this.cutter=new Cutter(e)}defaultState(){return Object.assign({none:!0,refreshCw:_refreshCw.default,rotateCw:_rotateCw.default,rotateCcw:_rotateCcw.default,zoomIn:_zoomIn.default,zoomOut:_zoomOut.default,folder:_folder.default},this.option)}defaultOption(){return{picWidth:100,picHeight:100,rotateoffset:5,zoomoffset:50,size:5}}change({e:e}){let t=e.target.files||e.dataTransfer.files;new _file.default(t[0]).getImageElement().then(e=>{this.cutter.setImage(e),this.state.none=!1,this.render()})}rotateLeft(){this.cutter.rotateLeft()}rotateRight(){this.cutter.rotateRight()}zoomIn(){this.cutter.zoomIn()}zoomOut(){this.cutter.zoomOut()}reset(){this.cutter.reset()}upload(){new _file.default(this.cutter.getImageBlob()).uploadAsForm({url:\"/movie/upload\"})}}).prototype,\"change\",[_dec2],Object.getOwnPropertyDescriptor(_class2.prototype,\"change\"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,\"rotateLeft\",[_dec3],Object.getOwnPropertyDescriptor(_class2.prototype,\"rotateLeft\"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,\"rotateRight\",[_dec4],Object.getOwnPropertyDescriptor(_class2.prototype,\"rotateRight\"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,\"zoomIn\",[_dec5],Object.getOwnPropertyDescriptor(_class2.prototype,\"zoomIn\"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,\"zoomOut\",[_dec6],Object.getOwnPropertyDescriptor(_class2.prototype,\"zoomOut\"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,\"reset\",[_dec7],Object.getOwnPropertyDescriptor(_class2.prototype,\"reset\"),_class2.prototype),_applyDecoratedDescriptor(_class2.prototype,\"upload\",[_dec8],Object.getOwnPropertyDescriptor(_class2.prototype,\"upload\"),_class2.prototype),_class=_class2))||_class);var _default=Photocutter;exports.default=_default;"},"P1782506081":{"hash":"0fec84aa","code":"<div class=\"cutter\" data-find=\"cutter\"></div><div class=\"tools\"><div class=\"tool\"><input type=\"file\" onchange=\"{{change()}}\"><@icon id=\"{{folder}}\" class=\"icon\"/></div><div class=\"tool\" onclick=\"{{rotateleft()}}\"><@icon id=\"{{rotateCcw}}\" class=\"icon\"/></div><div class=\"tool\" onclick=\"{{rotateright()}}\"><@icon id=\"{{rotateCw}}\" class=\"icon\"/></div><div class=\"tool\" onclick=\"{{zoomin()}}\"><@icon id=\"{{zoomIn}}\" class=\"icon\"/></div><div class=\"tool\" onclick=\"{{zoomout()}}\"><@icon id=\"{{zoomOut}}\" class=\"icon\"/></div><div class=\"tool\" onclick=\"{{reset()}}\"><@icon id=\"{{refreshCw}}\" class=\"icon\"/></div></div>{{if none===true}}<div class=\"mask\"><input type=\"file\" onchange=\"{{change()}}\"></div>{{/if}}"},"P268320843":{"hash":"308c5ce6","code":".photocutter{position:absolute;left:0;top:0;right:0;bottom:0}.photocutter .icon{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor}.photocutter .cutter{position:absolute;left:0;top:0;right:0;bottom:30px}.photocutter .tools{position:absolute;left:0;right:0;bottom:0;line-height:30px;display:flex;background:white;border-top:1px solid #d7d7d7}.photocutter .tools .tool{width:30px;text-align:center;position:relative;overflow:hidden;font-size:16px}.photocutter .tools .tool input{display:block;position:absolute;left:0;top:0;right:0;bottom:0;opacity:0}.photocutter .tools .tool:hover{background:#f5f5f5}.photocutter .mask{position:absolute;left:0;top:0;right:0;bottom:0}.photocutter .mask input{display:block;position:absolute;left:0;top:0;right:0;bottom:0;opacity:0}"}})